import"../chunks/CWj6FrbW.js";import{A as y,B as X,X as q,J as me,K as ve,U as he,am as pe,$ as _e,a4 as ke,R as Y,Q as Z,a3 as be,V as $e,T as ye,an as we,p as re,t as I,a as se,c as h,s as A,h as xe,r as p,f as F,i as t,ao as B,k as D,E as Ce,l as w}from"../chunks/B_07pKug.js";import{i as Pe,d as Ee,s as Le}from"../chunks/Ftfd5V-W.js";import{i as Ne,a as Ue,s as Se}from"../chunks/CO0o1QUp.js";import{e as oe,f as ee,i as Re,m as Ae,g as Ie,h as ze,j as Te,k as je,d as te}from"../chunks/maaO3fRk.js";import{b as Be,n as Me,a as C,c as G,t as K}from"../chunks/CUgi9AwD.js";import{p as ae}from"../chunks/Cefw4MdY.js";import{o as We}from"../chunks/DqzmXvvK.js";import{a as ne}from"../chunks/Bj1BzEJp.js";import"../chunks/CkXHWiK0.js";import{s as H}from"../chunks/D5elRSRu.js";import{l as M,p as N,s as ie}from"../chunks/BTHImQVC.js";import{i as Oe}from"../chunks/D4rl45nb.js";function Ve(m,r,v,_,s,n){let a=y;y&&X();var c,k,o=null;y&&q.nodeType===1&&(o=q,X());var P=y?q:m,l;me(()=>{const d=r()||null;var b=pe;d!==c&&(l&&(d===null?$e(l,()=>{l=null,k=null}):d===k?ye(l):we(l)),d&&d!==k&&(l=he(()=>{if(o=y?o:document.createElementNS(b,d),Be(o,o),_){y&&Pe(d)&&o.append(document.createComment(""));var $=y?_e(o):o.appendChild(ke());y&&($===null?Y(!1):Z($)),_(o,$)}be.nodes_end=o,P.before(o)})),c=d,c&&(k=c))},ve),a&&(Y(!0),Z(P))}/**
 * @license lucide-svelte v0.474.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const qe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var De=Me("<svg><!><!></svg>");function ce(m,r){const v=M(r,["children","$$slots","$$events","$$legacy"]),_=M(v,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);re(r,!1);let s=N(r,"name",8,void 0),n=N(r,"color",8,"currentColor"),a=N(r,"size",8,24),c=N(r,"strokeWidth",8,2),k=N(r,"absoluteStrokeWidth",8,!1),o=N(r,"iconNode",24,()=>[]);const P=(...u)=>u.filter((g,E,L)=>!!g&&L.indexOf(g)===E).join(" ");Oe();var l=De();let d;var b=h(l);oe(b,1,o,Re,(u,g)=>{let E=()=>t(g)[0],L=()=>t(g)[1];var z=G(),U=F(z);Ve(U,E,!0,(S,W)=>{let T;I(()=>T=ee(S,T,{...L()}))}),C(u,z)});var $=A(b);H($,r,"default",{}),p(l),I((u,g)=>d=ee(l,d,{...qe,..._,width:a(),height:a(),stroke:n(),"stroke-width":u,class:g}),[()=>k()?Number(c())*24/Number(a()):c(),()=>P("lucide-icon","lucide",s()?`lucide-${s()}`:"",v.class)],xe),C(m,l),se()}function Fe(m,r){const v=M(r,["children","$$slots","$$events","$$legacy"]);ce(m,ie({name:"chevron-left"},()=>v,{iconNode:[["path",{d:"m15 18-6-6 6-6"}]],children:(s,n)=>{var a=G(),c=F(a);H(c,r,"default",{}),C(s,a)},$$slots:{default:!0}}))}function Ge(m,r){const v=M(r,["children","$$slots","$$events","$$legacy"]);ce(m,ie({name:"chevron-right"},()=>v,{iconNode:[["path",{d:"m9 18 6-6-6-6"}]],children:(s,n)=>{var a=G(),c=F(a);H(c,r,"default",{}),C(s,a)},$$slots:{default:!0}}))}var Ke=K('<img alt="Manga Page">'),He=K('<audio class="background-sound" loop><source type="audio/ogg"></audio>'),Je=K('<div class="container svelte-3n9rkk"><div class="header"><h1> </h1></div> <div class="manga-container svelte-3n9rkk" role="presentation"><button class="nav-button prev-button svelte-3n9rkk"><!></button> <div class="manga-content svelte-3n9rkk"><!> <!></div> <button class="nav-button next-button svelte-3n9rkk"><!></button></div></div>');function lt(m,r){re(r,!0);const[v,_]=Ue(),s=()=>Se(Ae,"$manga",v);let n=B(D(parseInt(ae.params.chapterIndex))),a=B(D(parseInt(ae.params.pageIndex))),c={};const k=async({page:e,chapterIndex:i})=>{const f=`${i}-${e}`;return c[f]===void 0&&(c[f]=URL.createObjectURL(await ze({chapterIndex:i,page:e}))),c[f]};let o={};const P=async e=>(o[e]===void 0&&(o[e]=URL.createObjectURL(await Te(e))),o[e]);let l={};const d=async e=>(l[e]===void 0&&(l[e]=URL.createObjectURL(await je(e))),l[e]);let b=B(null),$=B(D([]));function u(e){g(),e instanceof KeyboardEvent&&(e.key==="ArrowLeft"?(e.preventDefault(),E()):e.key==="ArrowRight"&&(e.preventDefault(),L()))}function g(){document.querySelectorAll(".background-sound").forEach(i=>{i instanceof HTMLAudioElement&&i.play().then(()=>{}).catch(f=>{console.error("Background sound play failed:",f)})})}function E(){if(t(a)>0)w(a,t(a)-1);else if(t(n)>0){if(s()&&s().chapters[t(n)-1]){const e=s().chapters[t(n)-1].pages.length-1;w(n,t(n)-1),w(a,e)}}else alert("No more pages");ne(`/chapter/${t(n)}/${t(a)}`,{})}function L(){s()&&s().chapters[t(n)]&&t(a)<s().chapters[t(n)].pages.length-1?w(a,t(a)+1):s()&&t(n)<s().chapters.length-1?(w(a,0),w(n,t(n)+1)):alert("No more pages"),ne(`/chapter/${t(n)}/${t(a)}`,{})}const z=async({page:e,bgm:i,se:f,voice:V})=>{w(b,await k({page:e,chapterIndex:t(n)}),!0);let x=[];i!==null&&(x=[...x,await P(i)]);for(const ge of f)x=[...x,await d(ge)];V&&(x=[...x,URL.createObjectURL(await Ie({chapterIndex:t(n),page:e}))]),w($,x,!0),setTimeout(g,100)};Ce(()=>{if(s()===null){alert("Manga not initialized");return}const e=s().chapters[t(n)];if(e===void 0){alert(`Chapter ${t(n)+1} not found`);return}const i=e.pages[t(a)];if(i===void 0){alert(`Page ${t(a)+1} not found`);return}z(i)}),We(()=>(document.addEventListener("click",u),document.addEventListener("keydown",u),()=>{document.removeEventListener("click",u),document.removeEventListener("keydown",u)}));var U=Je(),S=h(U),W=h(S),T=h(W);p(W),p(S);var J=A(S,2),j=h(J);j.__click=E;var le=h(j);Fe(le,{size:48}),p(j);var R=A(j,2);R.__click=u,R.__keydown=u;var Q=h(R);{var de=e=>{var i=Ke();I(()=>te(i,"src",t(b))),C(e,i)};Ne(Q,e=>{t(b)!==null&&e(de)})}var ue=A(Q,2);oe(ue,16,()=>t($),e=>e,(e,i)=>{var f=He(),V=h(f);p(f),I(()=>te(V,"src",i)),C(e,f)}),p(R);var O=A(R,2);O.__click=L;var fe=h(O);Ge(fe,{size:48}),p(O),p(J),p(U),I(()=>Le(T,`Chapter ${t(n)+1} - Page ${t(a)+1}`)),C(m,U),se(),_()}Ee(["click","keydown"]);export{lt as component};
